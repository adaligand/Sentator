<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>No vowels - CSV vocab</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<style>
body { font-family: Arial, sans-serif; padding:20px; }
.container { max-width:800px; margin:auto; }
.title { font-size:40px; font-weight:bold; text-align:center; margin-bottom:20px; }
.subtitle { font-size:20px; margin-bottom:10px; }
.english-box { background-color:#e0e0e0; padding:10px; border-radius:10px; margin-bottom:10px; font-size:18px; text-align:center; }
.french-sentence { font-size:22px; margin-bottom:20px; }
.missing-word { width:18px; padding:0; font-size:22px; border:none; border-bottom:1px solid #000; text-align:center; margin-right:2px; }
.correct { background-color:#cef4ce; }
.incorrect { background-color:#ffb6c19c; }
#feedback { font-size:20px; font-weight:bold; display:flex; gap:10px; align-items:center; margin-bottom:10px; }
#keyboardContainer { text-align:center; margin-top:20px; }
.keyboard-button { font-size:18px; padding:10px 15px; margin:2px; border:none; border-radius:10px; background-color:#10148; color:#000; cursor:pointer; }
.keyboard-button:hover { background-color:#A9A9A9; transform:translateY(-4px); }
select { width:20%; padding:5px; border-radius:10px; margin-bottom:10px; height:35px; }
button { padding:10px 20px; font-size:18px; border-radius:10px; cursor:pointer; border:2px solid #ccc; background-color:#f9f9f9; }
button:hover { background-color:#A9A9A9; color:#fff; }
.hide { display:none; }
</style>
</head>
<body>
<div class="container">
  <div class="title">No vowels</div>
  <div class="subtitle">Fill in the missing vowels</div>

  <div id="englishBox" class="english-box"></div>
  <div id="exerciseOutput" class="french-sentence"></div>
  <div id="feedback" class="hide">
    <span id="feedbackMessage"></span>
    <button id="nextButton" class="hide">Next</button>
  </div>

  <select id="languageSelect">
    <option value="french" selected>French</option>
    <option value="german">German</option>
    <option value="spanish">Spanish</option>
  </select>
  <div id="keyboardContainer"></div>
</div>

<script>
let csvUrl = "YOUR_CSV_URL_HERE"; // CSV must have headers: French, English
let allPairs = [], pairs = [], currentIndex = 0, lastFocusedInput = null;
const vowels = ['a','e','i','o','u','à','â','ä','é','è','ê','ë','î','ï','ô','ö','ù','ü','û','á','é','í','ó','ú'];

Papa.parse(csvUrl,{
    download:true, header:true, skipEmptyLines:true,
    complete:function(results){
        results.data.forEach(row=>{
            if(row.French && row.English) allPairs.push({french: row.French.trim(), english: row.English.trim()});
        });
        if(allPairs.length===0){ alert("No items found in columns A or B!"); return; }
        shuffle(allPairs);
        pairs = allPairs.slice(0,10); // take 10 random words
        generateExercise();
    },
    error:function(){ alert("CSV load error"); }
});

function shuffle(array){ for(let i=array.length-1;i>0;i--){ let j=Math.floor(Math.random()*(i+1)); [array[i],array[j]]=[array[j],array[i]]; } }

function generateExercise(){
    const pair = pairs[currentIndex];
    const french = pair.french;
    document.getElementById('englishBox').textContent = pair.english;

    let html = '';
    for(let i=0;i<french.length;i++){
        let c = french[i];
        if(vowels.includes(c.toLowerCase())){
            html += `<input type="text" class="missing-word" data-index="${i}" maxlength="1" oninput="handleInput(this)" onfocus="lastFocusedInput=this">`;
        } else html += c;
    }
    document.getElementById('exerciseOutput').innerHTML = html;
    document.getElementById('feedback').classList.add('hide');
    document.getElementById('nextButton').classList.add('hide');
}

function handleInput(input){
    const pair = pairs[currentIndex];
    const correctChar = pair.french[input.dataset.index].toLowerCase();
    const val = input.value.toLowerCase();

    if(val===correctChar){ input.classList.add('correct'); input.classList.remove('incorrect'); }
    else{ input.classList.add('incorrect'); input.classList.remove('correct'); }

    // move to next input automatically
    const nextInput = input.nextElementSibling;
    if(nextInput && nextInput.classList.contains('missing-word')) nextInput.focus();

    checkAnswers();
}

function checkAnswers(){
    const inputs = document.querySelectorAll('.missing-word');
    const allCorrect = Array.from(inputs).every(inp=>inp.classList.contains('correct'));
    const feedback = document.getElementById('feedback');
    const message = document.getElementById('feedbackMessage');
    const nextBtn = document.getElementById('nextButton');

    if(allCorrect){
        feedback.classList.remove('hide');
        message.textContent = "Correct!";
        nextBtn.classList.remove('hide');
        nextBtn.onclick = nextWord;
    }
}

function nextWord(){
    currentIndex++;
    if(currentIndex>=pairs.length) currentIndex=0; // loop
    generateExercise();
}

// Keyboard insertion
function insertCharacter(character){
    if(lastFocusedInput){
        lastFocusedInput.value = character;
        handleInput(lastFocusedInput);
        // move cursor
        const nextInput = lastFocusedInput.nextElementSibling;
        if(nextInput && nextInput.classList.contains('missing-word')) nextInput.focus();
    }
}

function generateKeyboard(language){
    const container = document.getElementById('keyboardContainer');
    container.innerHTML='';
    let chars = [];
    switch(language){
        case 'german': chars=['ä','ö','ü','ß']; break;
        case 'french': chars=['à','â','ä','é','è','ê','ë','î','ï','ô','ö','ù','ü','û','ç']; break;
        case 'spanish': chars=['á','é','í','ó','ú','ñ']; break;
    }
    chars.forEach(c=>{
        const btn = document.createElement('button');
        btn.className='keyboard-button';
        btn.textContent=c;
        btn.onclick=()=>insertCharacter(c);
        container.appendChild(btn);
    });
}
document.getElementById('languageSelect').addEventListener('change',()=>generateKeyboard(document.getElementById('languageSelect').value));
generateKeyboard('french');
</script>
</body>
</html>
